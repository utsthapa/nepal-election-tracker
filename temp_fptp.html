

<!DOCTYPE html>
<html>
<head><meta name="viewport" content="width=device-width, initial-scale=1" /><title>
	मतगणना प्रगतिको विवरण
</title><link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png" /><link href="Styles/sm-simple.css" rel="stylesheet" type="text/css" /><link href="Styles/font-awesome/css/fontawesome.min.css" rel="stylesheet" type="text/css" /><link href="Styles/font-awesome/css/solid.min.css" rel="stylesheet" type="text/css" /><link href="Styles/font-awesome/css/brands.min.css" rel="stylesheet" type="text/css" /><link href="Styles/Site.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" href="/Styles/leaflet.css" /><link rel="stylesheet" href="/Styles/qgis2web.css" /><link href="Styles/bootstrap.min.css" rel="stylesheet" type="text/css" /><link href="Styles/animate.css" rel="stylesheet" type="text/css" />
    <script src="JSLibrary/jquery-2.1.1.min.js" type="text/javascript"></script>
    <script src="JQGridReq/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script src="JQGridReq/jquery-ui.js" type="text/javascript"></script>
    <link href="JQGridReq/jquery-ui.min.css" rel="stylesheet" type="text/css" />
    <script src="JQGridReq/jquery-1.9.0.min.js" type="text/javascript"></script>
    <script src="JQGridReq/grid.locale-en.js" type="text/javascript"></script>
    <script src="JQGridReq/jquery.jqGrid.js" type="text/javascript"></script>
    <link href="JQGridReq/ui.jqgrid.css" rel="stylesheet" type="text/css" />
    <script src="JQGridReq/jszip.min.js" type="text/javascript"></script>
    <script src="JSLibrary/jquery.smartmenus.js" type="text/javascript"></script>
    <script src="JSLibrary/bootstrap.min.js" type="text/javascript"></script>
    <script src="JSLibrary/WebCommon.js" type="text/javascript"></script>
    <script src="JSLibrary/knockout-3.5.1.js" type="text/javascript"></script>
    <link href="Styles/CustomStyle.css?v=0.27" rel="stylesheet" type="text/css" />

    <style>
        .ui-jqgrid .ui-pg-selbox
        {
            font-size: .8em;
            line-height: 18px;
            display: block;
            height: 18px;
            margin: 0;
            color: #000 !important;
        }
        .panel-group .panel .panel-heading h4 a:hover, .panel-group .panel .panel-heading h4 a:not(.collapsed)
        {
            /*background: #fff;*/
            transition: 0.15s all ease-in-out;
        }
        .panel-group .panel .panel-heading h4 a:not(.collapsed) i:before
        {
            content: "-";
            font-size: 30px;
            line-height: 10px;
        }
        .panel-group .panel .panel-heading h4 a i
        {
            color: #999;
            font-size: 12px;
        }
        .panel-group .panel .panel-body
        {
            padding-top: 0;
        }
        .panel-group .panel .panel-heading + .panel-collapse > .list-group, .panel-group .panel .panel-heading + .panel-collapse > .panel-body
        {
            border-top: none;
        }
        .panel-group .panel + .panel
        {
            border-top: none;
            margin-top: 0;
        }
        .panel
        {
            background: #1a3948;
        }
        .panel-default > .panel-heading
        {
            color: #fff;
            background-color: #2a5c73;
            border-top: 1px #1a3948 solid;
            border-color: #1a3948;
        }
        .panel-heading a
        {
            color: #fff;
            outline: none;
        }
        .panel-heading a:hover
        {
            text-decoration: none;
        }
        .panel-group .panel
        {
            border-radius: 0px;
        }
        .panel-default
        {
            border-color: #1a3948;
        }
        .panel-title
        {
            margin-top: 0;
            margin-bottom: 0;
            font-size: 12px;
            color: inherit;
            padding-left: 16px;
        }
        .pxlr-faq-body
        {
            padding: 0px;
        }
        .panel-title a
        {
            display: block;
        }
        .footer
        {
            font-weight: 600;
        }
    </style>
</head>
<body class="new-site">
    <header class="page">
        <div class="main-header">
            <img src="/Images/coat_of_arms.png" alt="ERIS" id="coat" class="img-responsive" style="float: left;" />
            <div class="header-title">
                <h1>
                    निर्वाचन आयोग</h1>
                <h2>
                    प्रतिनिधि/प्रदेश सभा निर्वाचन, २०७९</h2>
            </div>
            <img src="/Images/ecn-logo.jpg" alt="ERIS" id="logo" class="img-responsive" style="float: left;" />
            <div class="menu-activator" onclick="toggleMenu()">
                <img src="Images/menu.png" height="4em" />
            </div>
        </div>
    </header>
    <aside class="nav-side-menu animated slideInLeft demo">
        <div class="menu-list" id="menu">
        </div>
        <div class="menu-close" onclick="hideMenu()">&times;</div>

    </aside>
    <main>
        
    <div class="animated slideInRight">
        <div class="row">
            <div class="col-md-12">
                <h3 class="form-title" style="font-size: 15px; font-weight: bold; text-align: center"
                    id="pageTitle">
                    पहिलो हुने निर्वाचित हुने निर्वाचनमा मतगणनाको आधारमा दलगत स्थिति
                </h3>
                <div style="margin-left: 1em;">
                    <h5>* निर्वाचित उम्मेदवारहरुको विस्तृत विवरण हेर्नका लागि संख्यात्मक विवरणमा Click वा Tap गर्नुहोला ।</h5>
                </div>
                
                <div class="row pull-right" style="margin-right: -1em;">
                   
                   <a class="btn btn-primary" href="PRVoteChartResult.aspx">समानुपातिक</a>
                    <a class="btn btn-primary" href="MapElectionResult2079.aspx"><img src="Images/map.jpg" height="20" /> क्षेत्र गत विवरण</a>
                </div>
                <div class="chart-legends">
                    <div class="">
                        <div class="chart-legend" data-bind="style: { backgroundColor: ColorWin}">
                        </div>
                        <span>विजयी</span>
                    </div>
                    <div class="">
                        <div class="chart-legend" data-bind="style: { backgroundColor: ColorCand}">
                        </div>
                        <span>अग्रस्थान</span>
                    </div>
                </div>
                <div>
                    
                    
                    <div class="row" id="newcharts" data-bind="foreach: charts">
                        <div class="card-parent">
                            <div class="chart-container" data-bind="css: css">
                                <div class="chart-title">
                                    <div class="chartLabel">
                                        <span data-bind="text: title"></span> (<span data-bind="text: convertNepNumber(tot())">
                                        </span> / <span data-bind="text: convertNepNumber(tott)"></span>)
                                    </div>
                                    <div class="">
                                        विजयी: <span data-bind="text: convertNepNumber(totWin())"></span>
                                    </div>
                                </div>
                                <div class="chart-result">
                                    
                                    <div class="chart-result-body" data-bind="foreach: parties">
                                        <div class="chart-result-row">
                                            <div class="img-container" style="width: 60px; height: 60px;">
                                                <img title="Symbol" data-bind="attr:{ src: 'Images/symbol-hor-pa/'+ SymbolID +'.jpg?v=0.2'}" style="width: 60px;"
                                                    alt="Symbol" />
                                            </div>
                                            <div class="progresses">
                                                <div class="result-label" data-bind="text: PoliticalPartyName">
                                                </div>
                                                <div class="prog">
                                                    <div class="prog-count" data-bind="text: convertNepNumber(commafy(TotWin))">
                                                    </div>
                                                    <div class="progress-bg clickable" data-bind="click: $root.getDetails('Winner')">
                                                        <div class="progress-fg" data-bind="style: { width: percWin, backgroundColor: colorWin }">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="prog">
                                                    <div class="prog-count" data-bind="text: convertNepNumber(commafy(TotLead))">
                                                    </div>
                                                    <div class="progress-bg clickable" data-bind="click: $root.getDetails('Leader')">
                                                        <div class="progress-fg" data-bind="style: { width: percLead, backgroundColor: colorTot }">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="ModalDetails"  class="modal" data-bind="with: WinLeadDetails">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        &times;</button>
                    <h4 class="modal-title">
                        <span class="fa fa-times" style="cursor: pointer;" data-bind="click: $root.hidemodal"></span>
                        <span data-bind="text: PartyName"></span>
                        <span data-bind="text: ElectionName"></span>
                        <span data-bind="text: WinLead"></span>
                    </h4>
                </div>
                <div class="modal-body">
                    
                        <table class="table table-bordered table-sortable table-condensed tbl-middle tbl-responsive-data">
					    <thead>
                            <tr>
                                <th>क्र.स.</th>
                                <th>नि.क्षे.</th>
                                <th>उम्मेदवार</th>
							    <th class="text-right">प्राप्त मत</th>
						    </tr>
					    </thead>
					    <tbody data-bind="foreach: WinLeadList">
						    <tr class="clickable" data-bind="click: $root.dispDetail">
							    <td data-bind="text: convertNepNumber($index() + 1)">१</td>
							    <td>
                                    <div class="tbl-ea">
                                        <div class="tbl-ea-state" data-bind="text: StateName"></div>
                                        <div class="tbl-ea-dist" data-bind="text: DistrictName"></div>
                                        <div class="tbl-ea-const" data-bind="text: ConstName"></div>
                                    </div>
                                </td>
							    <td>
                                    <div class="tbl-cand">
                                        <div class="tbl-cand-photo">
                                            <img title="Photo" data-bind="attr:{ src: 'Images/Candidate/'+ CandidateId +'.jpg'}"
                                                alt="Photo" width='50' />
                                        </div>
                                        <div class="tbl-cand-det">
                                            <div class="tbl-cand-name">
                                                <span data-bind="text: CandidateName"></span>
                                                (<span class="tbl-cand-age-sex" data-bind="text: convertNepNumber(Age)"></span>
                                                <span class="tbl-cand-age-sex" data-bind="text: GenderDesc"></span>)
                                            </div>
                                            <div class="tbl-party">
                                                <div class="tbl-party-symbol">
                                                    <img title="Symbol" data-bind="attr:{ src: 'Images/symbol-hor-pa/'+ SymbolId +'.jpg?v=0.2'}" alt="Symbol" src="" width="25" height="25">
                                                </div>
                                                <div class="tbl-party-name" data-bind="text: PartyName">
                                            </div>
                                        </div>
                                    </div>
                                </td>
							    <td class="tbl-cand-vote-count text-right" data-bind="text: convertNepNumber(commafy(TotalVote || 0))"></td>
						    </tr>
					    </tbody>
				    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="JSLibrary/amcharts.js" type="text/javascript"></script>
    <script src="JSLibrary/pie.js" type="text/javascript"></script>
    <script src="//www.amcharts.com/lib/3/plugins/dataloader/dataloader.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $("#banner-Image").attr("src", "/Images/header1.png");
        
        function ChartResultVM () {
            var self = this;
            self.WinLeadDetails = ko.observable({
                PartyName: '',
                ElectionName: 'प्रतिनिधि सभा',
                WinLead: 'विजयी',
                WinLeadList: [],
            });
            self.dispDetail = x => {
                console.log(x);
                window.location = `/MapElectionResult2079.aspx?state=${x.StateId}&dist=${x.DistrictCd}&const=${x.ScConstId}`;
            };
            let baseCharts = [
                { tott: 165, id: 'chartMayor', title: 'प्रतिनिधि सभा', file: 'HoRPartyTop5.txt', ecLvlId: 5, css: 'emphasis' },
                { tott: 56, id: 'chartChairPerson', title: ' प्रदेश सभा प्रदेश न. १', file: 'PAPartyTop5-S1.txt', ecLvlId: 4, stateId: 1, css: '' },
                { tott: 64, id: 'chartDeputyMayor', title: 'प्रदेश सभा मधेश प्रदेश', file: 'PAPartyTop5-S2.txt', ecLvlId: 4, stateId: 2, css: '' },
                { tott: 66, id: 'chartDeputyChairPerson', title: 'प्रदेश सभा बागमती प्रदेश', file: 'PAPartyTop5-S3.txt', ecLvlId: 4, stateId: 3, css: '' },
                { tott: 36, id: 'chartWardChairPerson', title: 'प्रदेश सभा गण्डकी प्रदेश', file: 'PAPartyTop5-S4.txt', ecLvlId: 4, stateId: 4, css: '' },
                { tott: 52, id: 'chartWomen', title: 'प्रदेश सभा लुम्बिनी प्रदेश ', file: 'PAPartyTop5-S5.txt', ecLvlId: 4, stateId: 5, css: '' },
                { tott: 24, id: 'chartDalitWomen', title: 'प्रदेश सभा कर्णाली प्रदेश', file: 'PAPartyTop5-S6.txt', ecLvlId: 4, stateId: 6, css: '' },
                { tott: 32, id: 'chartMember', title: 'प्रदेश सभा सूदूरपश्चिम प्रदेश', file: 'PAPartyTop5-S7.txt', ecLvlId: 4, stateId: 7, css: '' },
            ].map(x => ({...x, parties: ko.observable([]), tot: ko.observable(0), totWin: ko.observable(0)}));

            self.charts = ko.observableArray(baseCharts);
        
            let GetJSONData = function (chart) {
                return $.getJSON('/JSONFiles/Election2079/Common/' + chart.file).then(function (data) {
                    return data;
                });
            };

            self.hidemodal=function(){
                $('#ModalDetails').modal('hide');
            }

            self.getDetails = wl => data => {
                let type = data.PartyId == 9999 ? 'T6' : 'T5';
                let ecType = data.ecLvlId == 5 ? 'HOR' : 'PA';
                let prefix = ecType + (data.stateId ? '-' + data.stateId : '') + '-' + type;
                let file = prefix + wl + '.json';
                $.getJSON('/JSONFiles/Election2079/Common/' + file).then(list => {
                    let arr = list.filter(x => data.PartyId == 9999 || data.PartyId == x.PartyId);
                    console.log(arr, data);
                    self.WinLeadDetails({
                        PartyName: data.PoliticalPartyName,
                        ElectionName: data.ecLvlId == 5 ? 'प्रतिनिधि सभा' : 'प्रदेश सभा',
                        WinLead: wl == 'Winner' ? 'विजयी' : 'अग्रस्थान',
                        WinLeadList: arr,
                    });
                    $('#ModalDetails').modal('show');
                });
            };

            self.ColorCand = ko.observable(gv_prog_blue);
            self.ColorWin = ko.observable(gv_prog_red);

            self.chart = ko.observableArray([]);
            
            self.GetPramukh = () => {};


            self.charts().map((chart, j) => {
                GetJSONData(chart).done(data => {
                    let tot = data.reduce((a, b) => a + +b.TotWin +b.TotLead, 0);
                    let totWin = data.reduce((a, b) => a + +b.TotWin, 0);
                    let max = Math.max(...data.map(y => [+y.TotWin, +y.TotLead]).flat());
                    chart.parties(data.map((y, i) => ({
                        ...y,
                        colorTot: gv_prog_blue,
                        colorWin: gv_prog_red,
                        // percTot: (y.t_cand / max * 100).toFixed(2) + '%',
                        percWin: ((y.TotWin) / max * 100).toFixed(2) + '%',
                        percLead: (( y.TotLead) / max * 100).toFixed(2) + '%',
                        stateId: chart.stateId,
                        ecLvlId: chart.ecLvlId,
                    })));
                    chart.tot(tot);
                    chart.totWin(totWin);
                    self.chart(data.map((x, i) => ({
                        Id: i,
                        Label: x.PoliticalPartyName,
                        TotalCount: x.t_cand,
                        SymbolID: x.SymbolID,
                        LegendId: 1,
                    })));
                });
            });
        }

        $(function() {
            var vm = new ChartResultVM();
            ko.applyBindings(vm);
        });
    </script>

    </main>
    <footer>
        <div class="col-md-12">
            Powered by <a href="http://pcs.com.np/">PCS</a>
        </div>
    </footer>
    <script type="text/javascript" src="/JSLibrary/Common.js?v=0.9"></script>
    <script type="text/javascript">
        genMenu();

        function hideMenu() {
            document.querySelector('body').classList.remove('menu-active');
        }

         

        function showMenu() {
            document.querySelector('body').classList.add('menu-active');
        }
        function toggleMenu() {
            document.querySelector('body').classList.toggle('menu-active');
        }

        $('')

        var allowedKeys = {
            37: 'left',
            38: 'up',
            39: 'right',
            40: 'down',
            65: 'a',
            66: 'b'
        };
        var konamiCode = ['up', 'up', 'down', 'down', 'left', 'right', 'left', 'right', 'b', 'a'];
        var konamiCodePosition = 0;
        document.addEventListener('keydown', function (e) {
            var key = allowedKeys[e.keyCode];
            var requiredKey = konamiCode[konamiCodePosition];
            if (key == requiredKey) {
                konamiCodePosition++;
                if (konamiCodePosition == konamiCode.length) {
                    let theme = localStorage.getItem('theme');
                    let newTheme = theme == 'light' ? 'dark' : 'light';
                    localStorage.setItem('theme', newTheme);
                    konamiCodePosition = 0;
                }
            } else {
                konamiCodePosition = 0;
            }
        });
    </script>
</body>
</html>
